---
description: Semantic Versioning and Release Management Protocol
globs: **/*
---

# Semantic Versioning Protocol

## Overview
This extension follows **Semantic Versioning 2.0.0** (semver.org) strictly.

## Version Format
```
MAJOR.MINOR.PATCH[-PRERELEASE][+BUILD]
```

Example: `1.2.3-beta.1+20241205`

## Version Increment Rules

### MAJOR (X.0.0)
Increment when making **incompatible API changes** or **breaking changes**:
- Removing or renaming commands
- Changing configuration schema in non-backward-compatible ways
- Removing support for older VS Code versions
- Major architectural rewrites that break existing workflows
- **Requires:** Migration guide in CHANGELOG.md

### MINOR (0.X.0)
Increment when adding **new features** in a backward-compatible manner:
- New commands or views
- New configuration options (with defaults)
- New ticket templates or workflows
- Enhanced UI features
- **Requires:** Feature documentation in CHANGELOG.md

### PATCH (0.0.X)
Increment when making **backward-compatible bug fixes**:
- Bug fixes
- Performance improvements
- Security patches (non-breaking)
- Documentation updates
- Refactoring without behavior changes
- **Requires:** Bug fix description in CHANGELOG.md

### Pre-release Versions
Format: `X.Y.Z-identifier.N`

**Identifiers:**
- `alpha`: Early testing, incomplete features
- `beta`: Feature complete, testing phase
- `rc`: Release candidate, final testing

**Examples:**
- `1.0.0-alpha.1` - First alpha
- `1.0.0-beta.2` - Second beta
- `1.0.0-rc.1` - Release candidate

**Progression:**
```
1.0.0-alpha.1 â†’ 1.0.0-alpha.2 â†’ 1.0.0-beta.1 â†’ 1.0.0-rc.1 â†’ 1.0.0
```

## Version Commands

### Manual Versioning
```bash
npm version patch  # 1.0.0 â†’ 1.0.1
npm version minor  # 1.0.0 â†’ 1.1.0
npm version major  # 1.0.0 â†’ 2.0.0

npm version prerelease --preid=beta  # 1.0.0 â†’ 1.0.1-beta.0
npm version prepatch --preid=alpha   # 1.0.0 â†’ 1.0.1-alpha.0
npm version preminor --preid=beta    # 1.0.0 â†’ 1.1.0-beta.0
npm version premajor --preid=rc      # 1.0.0 â†’ 2.0.0-rc.0
```

### Automated Versioning (CI/CD)
Versions are automatically determined from commit messages following Conventional Commits.

## Commit Message â†’ Version Mapping

| Commit Prefix | Version Change | Example |
|---------------|----------------|---------|
| `fix:` | PATCH | `fix: resolve ticket loading bug` |
| `feat:` | MINOR | `feat: add kanban drag-drop` |
| `BREAKING CHANGE:` | MAJOR | `feat!: redesign ticket schema` |
| `perf:` | PATCH | `perf: optimize ticket parsing` |
| `docs:` | No version change | `docs: update README` |
| `chore:` | No version change | `chore: update dependencies` |

## Release Checklist

### Before Release
- [ ] All tests pass (`npm run test`)
- [ ] Linter passes (`npm run lint`)
- [ ] Build succeeds (`npm run compile`)
- [ ] CHANGELOG.md updated with changes
- [ ] Version bumped in `package.json`
- [ ] Git tag created (`git tag v1.0.0`)

### Release Process
1. **Create Release Branch** (for major/minor)
   ```bash
   git checkout -b release/v1.2.0
   ```

2. **Update CHANGELOG.md**
   ```markdown
   ## [1.2.0] - 2024-12-05
   ### Added
   - Feature X
   ### Fixed
   - Bug Y
   ```

3. **Bump Version**
   ```bash
   npm version minor -m "chore: release v%s"
   ```

4. **Push Tag**
   ```bash
   git push origin v1.2.0
   ```

5. **GitHub Actions** will:
   - Build extension
   - Run tests
   - Create GitHub Release
   - Publish .vsix artifact

### After Release
- [ ] Verify release on GitHub
- [ ] Test installed extension from .vsix
- [ ] Announce release (if public)
- [ ] Merge release branch to `main` and `develop`

## Version Constraints

### Dependencies
- **VS Code Engine:** Specify minimum version in `package.json`
  ```json
  "engines": {
    "vscode": "^1.85.0"
  }
  ```

### Breaking Changes Documentation
When incrementing MAJOR version, create:
- `docs/migration/v1-to-v2.md`
- Include:
  - What changed
  - Why it changed
  - How to migrate
  - Code examples

## Version States

| State | Description | Branch | Stability |
|-------|-------------|--------|-----------|
| `alpha` | Experimental, unstable | `develop` | âš ï¸ Unstable |
| `beta` | Feature complete, testing | `release/vX.Y.0` | ðŸ”¶ Testing |
| `rc` | Release candidate | `release/vX.Y.0` | âœ… Stable |
| Stable | Production ready | `main` | âœ… Stable |

## Automated Version Detection

### CI/CD Version Bump Logic
```yaml
# Determined from commit messages since last tag
- fix: commit â†’ PATCH
- feat: commit â†’ MINOR
- BREAKING CHANGE: â†’ MAJOR
- No version-changing commits â†’ No release
```

### Version in Extension
Display current version in:
- Status bar (optional)
- About panel
- Extension marketplace listing

## Hotfix Protocol

For critical bugs in production:
1. Create hotfix branch from `main`
   ```bash
   git checkout -b hotfix/v1.2.1 main
   ```
2. Fix bug
3. Bump PATCH version
4. Tag and release
5. Merge to both `main` and `develop`

## Version Enforcement

### Pre-commit Hooks
- Verify version in `package.json` matches expected pattern
- Ensure CHANGELOG.md is updated for version changes

### CI Validation
- Fail build if version already exists as git tag
- Validate semver format
- Check that version > previous version

## Examples

### Scenario 1: Bug Fix
```bash
# Current: 1.2.3
git commit -m "fix: resolve search query bug"
# CI detects 'fix:' â†’ bumps to 1.2.4
```

### Scenario 2: New Feature
```bash
# Current: 1.2.4
git commit -m "feat: add export to PDF"
# CI detects 'feat:' â†’ bumps to 1.3.0
```

### Scenario 3: Breaking Change
```bash
# Current: 1.3.0
git commit -m "feat!: redesign ticket storage format

BREAKING CHANGE: Ticket metadata schema changed. Run migration script."
# CI detects 'BREAKING CHANGE:' â†’ bumps to 2.0.0
```

## References
- [Semantic Versioning 2.0.0](https://semver.org/)
- [Conventional Commits](https://www.conventionalcommits.org/)
- [Keep a Changelog](https://keepachangelog.com/)
